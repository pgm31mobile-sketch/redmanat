<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no">
<title>Mobil UI</title>

<style>
    body {
        margin: 0;
        background: #0f0f0f;
        font-family: Arial, sans-serif;
        color: white;
        overscroll-behavior: none;
        touch-action: manipulation;
    }

    .container {
        padding: 15px;
        padding-bottom: 120px;
    }

    .card {
        background: #1a1a1a;
        border-radius: 20px;
        padding: 18px;
        margin-bottom: 18px;
    }

    .row {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .profile {
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .profile img {
        width: 55px;
        height: 55px;
        border-radius: 50%;
        border: 3px solid #1e90ff; /* mavi */
        object-fit: cover;
    }

    .lang-btn {
        background: #1e90ff; /* mavi */
        padding: 10px 16px;
        border-radius: 12px;
        font-weight: bold;
    }

    .balance-big {
        font-size: 28px;
        font-weight: bold;
        margin-top: 6px;
    }

    .sub {
        color: #4aa3ff; /* a√ßƒ±q mavi */
        margin-top: -5px;
    }

    .adv-grid {
        display: flex;
        justify-content: space-between;
        margin: 20px 0;
    }

    .adv-box {
        width: 48%;
        background: #1f1f1f;
        padding: 18px;
        border-radius: 20px;
        text-align: center;
    }

    .adv-box .num {
        font-size: 28px;
        font-weight: bold;
        color: #1e90ff; /* mavi */
    }

    .progress {
        width: 100%;
        height: 8px;
        background: #333;
        border-radius: 10px;
        margin: 10px 0;
    }

    .progress-bar {
        width: 0%;
        height: 100%;
        background: #1e90ff; /* mavi */
        border-radius: 10px;
    }

    .watch-btn {
        width: 100%;
        padding: 15px;
        border: none;
        border-radius: 14px;
        background: #1e90ff; /* mavi */
        color: white;
        font-size: 18px;
        font-weight: bold;
        margin-top: 10px;
        cursor: pointer;
    }

    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background: #1a1a1a;
        display: flex;
        justify-content: space-evenly;
        padding: 14px 0;
        border-top: 1px solid #333;
        box-sizing: border-box;
        z-index: 999;
        gap: 2px;
    }

    .nav-item {
        flex: 1;
        text-align: center;
        font-size: 14px;
        color: #bbb;
        cursor: pointer;
        padding: 8px 0;
    }

    .nav-item.active {
        color: #1e90ff; /* mavi */
        font-weight: bold;
    }

    .nav-item br {
        line-height: 1.1;
    }
</style>
</head>
<body>

<div class="container">

    <!-- PROFILE CARD -->
    <div class="card">
        <div class="row">
            <div class="profile">
                <img id="userPhoto" src="https://via.placeholder.com/150" alt="profile">
                <div>
                    <div id="userName" style="font-size:18px;">Y√ºkl…ônir...</div>
                    <div id="userTag" style="color:#aaa;"></div>
                </div>
            </div>
            <div class="lang-btn">AZ</div>
        </div>
    </div>

    <!-- BALANCE CARD -->
    <div class="card">
        <div style="color:#888;">Balansƒ±nƒ±z</div>
        <div class="balance-big" id="bal">0.000 ‚Çº</div>
        <div class="sub">‚âà $0.000</div>
    </div>

    <!-- AD CARD -->
    <div class="card">
        <div class="row">
            <div>
                <h2 style="margin:0;">Reklam 1</h2>
                <div style="color:#aaa;">H…ôr reklam √º√ß√ºn 0.001‚Çº qazanƒ±n</div>
            </div>
            <div class="lang-btn" style="font-size:24px;">‚òÅ</div>
        </div>

        <div class="adv-grid">
            <div class="adv-box">
                <div class="num" id="watchedCount">0</div>
                <div style="color:#f2f2f2;">ƒ∞zl…ôn…ôn reklamlar</div>
            </div>
            <div class="adv-box">
                <div class="num">50</div>
                <div style="color:#f2f2f2;">Maksimum</div>
            </div>
        </div>

        <div style="color:#ccc;">ƒ∞r…ôlil…ôyi≈ü</div>
        <div class="progress">
            <div id="progressBar" class="progress-bar"></div>
        </div>

        <button class="watch-btn" id="watchBtn">‚ñ∂ ƒ∞ndi izl…ô</button>
    </div>

</div>

<!-- BOTTOM MENU -->
<div class="bottom-nav">
    <div class="nav-item" onclick="window.location.href='home.html'">üè†<br>Ev</div>
    <div class="nav-item" onclick="window.location.href='tasks.html'">üìù<br>Tap≈üƒ±rƒ±qlar</div>
    <div class="nav-item" onclick="window.location.href='withdraw.html'">üí≤<br>√áƒ±xarƒ±≈ü</div>
</div>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let userName = "";
let userTag = "";

const tgUser = tg.initDataUnsafe.user;

if (tgUser) {
    userName = tgUser.first_name + (tgUser.last_name ? " " + tgUser.last_name : "");
    userTag = tgUser.username ? "@" + tgUser.username : "";

    document.getElementById("userPhoto").src = tgUser.photo_url || "https://via.placeholder.com/150";
    document.getElementById("userName").textContent = userName;
    document.getElementById("userTag").textContent = userTag;
}

let balance = 0.000;
let watchedAds = 0;
let totalAds = 50;

if (localStorage.getItem("userData")) {
    const saved = JSON.parse(localStorage.getItem("userData"));

    balance = saved.balans;
    watchedAds = saved.ads;

    document.getElementById("bal").textContent = balance.toFixed(3) + " ‚Çº";
    document.getElementById("watchedCount").textContent = watchedAds;

    let percent = (watchedAds / totalAds) * 100;
    document.getElementById("progressBar").style.width = percent + "%";
}

function saveUserData() {
    const jsonData = {
        name: userName,
        tag: userTag,
        balans: balance,
        ads: watchedAds,
        totalads: totalAds
    };
    localStorage.setItem("userData", JSON.stringify(jsonData));
}

function loadSDK(callback) {
    const script = document.createElement("script");
    script.src = "//libtl.com/sdk.js";
    script.setAttribute("data-zone", "10219617");
    script.setAttribute("data-sdk", "show_10219617");
    script.onload = callback;
    document.body.appendChild(script);
}

const watchBtn = document.getElementById("watchBtn");

watchBtn.addEventListener("click", () => {

    if (watchedAds >= totalAds) {
        watchBtn.textContent = "Limit bitib";
        return;
    }

    watchBtn.disabled = true;
    watchBtn.textContent = "Reklam a√ßƒ±lƒ±r...";

    loadSDK(() => {

        if (typeof show_10219617 === "function") {
            show_10219617();
        }

        let timeLeft = 10;
        watchBtn.textContent = "Reklam gedir (10s)";

        const timer = setInterval(() => {
            timeLeft--;
            watchBtn.textContent = `Reklam gedir (${timeLeft}s)`;

            if (timeLeft <= 0) {
                clearInterval(timer);

                watchedAds += 1;
                balance += 0.001;

                document.getElementById("watchedCount").textContent = watchedAds;
                document.getElementById("bal").textContent = balance.toFixed(3) + " ‚Çº";

                let percent = (watchedAds / totalAds) * 100;
                document.getElementById("progressBar").style.width = percent + "%";

                saveUserData();

                watchBtn.textContent = "‚ñ∂ ƒ∞ndi izl…ô";
                watchBtn.disabled = false;
            }
        }, 1000);
    });
});


// DAILY RESET AT BAKU MIDNIGHT
const LIMIT = 100, REWARD = 0.005;
const BAL_KEY = 'bal', COUNT_KEY = 'cnt', RESET_KEY = 'resetTime';

// LocalStorage t…ôhl√ºk…ôsiz oxuma/yazma
function safeGet(k, d = 0){ try { return JSON.parse(localStorage.getItem(k)) ?? d; } catch { return d; } }
function safeSet(k, v){ try { localStorage.setItem(k, JSON.stringify(v)); } catch(e){} }

// Balans v…ô sayƒüaclarƒ± y√ºkl…ôyirik
let bal = parseFloat(safeGet(BAL_KEY, 0));
let cnt = parseInt(safeGet(COUNT_KEY, 0));
let resetTime = safeGet(RESET_KEY, null);

// ‚û§ 24 saatlƒ±q RESET FUNKSƒ∞YASI
function getNextResetTime(){
  const now = new Date();
  const AZ_OFFSET = 4; // Az…ôrbaycan vaxtƒ± √º√ß√ºn +4 saat

  // N√∂vb…ôti Az…ôrbaycan vaxtƒ± il…ô gec…ô 00:00
  let resetUTC = new Date(Date.UTC(
    now.getUTCFullYear(),
    now.getUTCMonth(),
    now.getUTCDate(),
    23 - AZ_OFFSET, // Bakƒ± vaxtƒ±nda 00:00 dem…ôkdir
    0, 0, 0
  ));

  // ∆èg…ôr artƒ±q ke√ßibs…ô ‚Üí sabaha t…ôyin et
  if(now.getTime() > resetUTC.getTime()){
    resetUTC.setUTCDate(resetUTC.getUTCDate() + 1);
  }
  return resetUTC.getTime();
}

// ƒ∞lk giri≈üd…ô v…ô ya vaxtƒ± ke√ßib ‚Üí sƒ±fƒ±rla
if(!resetTime || Date.now() > resetTime){
  cnt = 0;
  resetTime = getNextResetTime();
  safeSet(RESET_KEY, resetTime);
  safeSet(COUNT_KEY, cnt);
}


// ANTI ZOOM / ANTI CHEAT
document.addEventListener("gesturestart", e => e.preventDefault());
document.addEventListener("gesturechange", e => e.preventDefault());
document.addEventListener("gestureend", e => e.preventDefault());

document.addEventListener("wheel", function(e) {
    if (e.ctrlKey) e.preventDefault();
}, { passive: false });

document.addEventListener('touchmove', function (event) {
    if (event.scale !== 1) event.preventDefault();
}, { passive: false });


// BOTTOM NAV ACTIVE LOGIC
const navItems = document.querySelectorAll(".nav-item");
const currentPage = window.location.pathname.split("/").pop();

navItems.forEach(item => {
    const onclickAttr = item.getAttribute("onclick");
    if (!onclickAttr) return;
    const href = onclickAttr.match(/'(.+?)'/)[1];
    
    if (href === currentPage) {
        item.classList.add("active");
    } else {
        item.classList.remove("active");
    }
});
</script>

</body>
</html>
